---
import Container from "../components/container.astro";
import Sectionhead from "../components/sectionhead.astro";
import Layout from "../layouts/Layout.astro";
import { getLocale } from "astro-i18n-aut";
import { useTranslations } from "../utils/i18n";

// Get locale and translations function
const locale = getLocale(Astro.url);
const t = useTranslations(Astro.url);

const timelineAccents = ["#0f766e", "#f59e0b", "#2563eb", "#f97316", "#14b8a6", "#e11d48"];

// Timeline events with translation keys
const timelineEvents = [
  {
    dateKey: "timeline.events.event9.date",
    titleKey: "timeline.events.event9.title",
    descriptionKey: "timeline.events.event9.description"
  },
  {
    dateKey: "timeline.events.event10.date",
    titleKey: "timeline.events.event10.title",
    descriptionKey: "timeline.events.event10.description"
  },
  {
    dateKey: "timeline.events.event1.date",
    titleKey: "timeline.events.event1.title",
    descriptionKey: "timeline.events.event1.description"
  },
  {
    dateKey: "timeline.events.event2.date",
    titleKey: "timeline.events.event2.title",
    descriptionKey: "timeline.events.event2.description"
  },
  {
    dateKey: "timeline.events.event3.date",
    titleKey: "timeline.events.event3.title",
    descriptionKey: "timeline.events.event3.description"
  },
  {
    dateKey: "timeline.events.event4.date",
    titleKey: "timeline.events.event4.title",
    descriptionKey: "timeline.events.event4.description"
  },
  {
    dateKey: "timeline.events.event5.date",
    titleKey: "timeline.events.event5.title",
    descriptionKey: "timeline.events.event5.description"
  },
  {
    dateKey: "timeline.events.event6.date",
    titleKey: "timeline.events.event6.title",
    descriptionKey: "timeline.events.event6.description"
  },
  {
    dateKey: "timeline.events.event7.date",
    titleKey: "timeline.events.event7.title",
    descriptionKey: "timeline.events.event7.description"
  },
  {
    dateKey: "timeline.events.event8.date",
    titleKey: "timeline.events.event8.title",
    descriptionKey: "timeline.events.event8.description"
  }
];

// Helper function to create locale-aware paths
function createLocalePath(path: string) {
  if (locale === "en") {
    return path;
  }
  return `/${locale}${path}`;
}
---

<Layout title={t('timeline.pageTitle')}>
  <div class="timeline-page">
    <Container>
      <div class="tl-head">
        <Sectionhead>
          <Fragment slot="title">{t('timeline.sectionTitle')}</Fragment>
          <Fragment slot="desc">{t('timeline.sectionSubtitle')}</Fragment>
        </Sectionhead>
      </div>

      <div class="tl-intro mx-auto max-w-4xl mt-16">
        <h2 class="text-3xl font-bold text-slate-900">
          {t('timeline.milestonesTitle')}
        </h2>
        <p class="mt-4 text-lg leading-relaxed text-slate-600">
          {t('timeline.milestonesDescription')}
        </p>
      </div>

      <div class="mx-auto max-w-5xl mt-12 mb-16">
        <div class="tl-rail">
          <div class="space-y-10 md:space-y-12">
            {timelineEvents.map((event, index) => {
              const isRight = index % 2 === 0;
              return (
                <article
                  class={`tl-item md:grid md:grid-cols-2 tl-reveal ${isRight ? 'tl-item--right' : 'tl-item--left'}`}
                  style={`--tl-accent: ${timelineAccents[index % timelineAccents.length]}; --tl-delay: ${0.1 + index * 0.08}s;`}
                >
                  <span class="tl-marker" aria-hidden="true">
                    <span class="tl-dot"></span>
                  </span>
                  <div
                    class={`tl-card p-6 pl-12 md:pl-6 ${isRight ? 'md:col-start-2 md:ml-10' : 'md:col-start-1 md:mr-10 md:justify-self-end md:row-start-1'}`}
                  >
                    <span class="tl-date">{t(event.dateKey)}</span>
                    <h3 class="tl-title">{t(event.titleKey)}</h3>
                    <p class="tl-desc">{t(event.descriptionKey)}</p>
                  </div>
                </article>
              );
            })}
          </div>
        </div>
        
        <div class="mt-16 text-center">
          <a href={createLocalePath("/contact")} class="tl-cta">
            {t('timeline.ctaButton')}
          </a>
        </div>
      </div>
    </Container>
  </div>
</Layout>

<style>
  :global(body) {
    background:
      radial-gradient(circle at 12% 12%, rgba(20, 184, 166, 0.12), transparent 40%),
      radial-gradient(circle at 82% 18%, rgba(244, 177, 128, 0.18), transparent 45%),
      linear-gradient(180deg, #f8fafc 0%, #ffffff 48%, #f1f5f9 100%);
  }

  :global(main) {
    background: transparent;
  }

  .timeline-page {
    --tl-ink: #0f172a;
    --tl-muted: #64748b;
    --tl-line: rgba(15, 23, 42, 0.12);
    --tl-card: rgba(255, 255, 255, 0.92);
    --tl-shadow: 0 24px 60px rgba(15, 23, 42, 0.08);
    min-height: 100vh;
    padding-bottom: 2.5rem;
    background:
      radial-gradient(circle at 12% 12%, rgba(20, 184, 166, 0.12), transparent 40%),
      radial-gradient(circle at 82% 18%, rgba(244, 177, 128, 0.18), transparent 45%),
      linear-gradient(180deg, #f8fafc 0%, #ffffff 48%, #f1f5f9 100%);
  }

  .timeline-page .tl-head h1 {
    color: var(--tl-ink);
  }

  .timeline-page .tl-head p {
    color: var(--tl-muted);
  }

  .timeline-page .tl-rail {
    position: relative;
  }

  .timeline-page .tl-rail::before {
    content: "";
    position: absolute;
    top: 0;
    bottom: 0;
    left: 1.25rem;
    width: 2px;
    border-radius: 999px;
    background: linear-gradient(180deg, rgba(15, 23, 42, 0.2), rgba(15, 23, 42, 0.05));
  }

  .timeline-page .tl-item {
    position: relative;
  }

  .timeline-page .tl-marker {
    position: absolute;
    left: 1.25rem;
    top: 1.8rem;
    transform: translateX(-50%);
  }

  .timeline-page .tl-dot {
    display: block;
    width: 0.85rem;
    height: 0.85rem;
    border-radius: 999px;
    background: var(--tl-accent);
    border: 3px solid #ffffff;
    box-shadow:
      0 0 0 6px rgba(15, 23, 42, 0.08),
      0 18px 30px rgba(15, 23, 42, 0.16);
  }

  .timeline-page .tl-card {
    position: relative;
    border-radius: 1.5rem;
    border: 1px solid rgba(15, 23, 42, 0.1);
    background: linear-gradient(135deg, var(--tl-card), rgba(248, 250, 252, 0.9));
    box-shadow: var(--tl-shadow);
    backdrop-filter: blur(10px);
    overflow: hidden;
  }

  .timeline-page .tl-card::before {
    content: "";
    position: absolute;
    inset: 0 0 auto 0;
    height: 3px;
    background: linear-gradient(90deg, var(--tl-accent), transparent 70%);
    opacity: 0.9;
  }

  .timeline-page .tl-date {
    display: inline-flex;
    align-items: center;
    padding: 0.35rem 0.9rem;
    border-radius: 999px;
    background: var(--tl-accent);
    background: color-mix(in srgb, var(--tl-accent) 85%, #ffffff 15%);
    color: #ffffff;
    font-size: 0.75rem;
    font-weight: 600;
    letter-spacing: 0.08em;
  }

  .timeline-page .tl-title {
    margin-top: 0.85rem;
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--tl-ink);
  }

  .timeline-page .tl-desc {
    margin-top: 0.5rem;
    color: var(--tl-muted);
    line-height: 1.7;
  }

  .timeline-page .tl-cta {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.9rem 2.4rem;
    border-radius: 999px;
    background: var(--tl-ink);
    color: #ffffff;
    font-weight: 600;
    letter-spacing: 0.05em;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    box-shadow: 0 18px 30px rgba(15, 23, 42, 0.18);
  }

  .timeline-page .tl-cta:hover {
    transform: translateY(-2px);
    background: #1e293b;
    box-shadow: 0 22px 35px rgba(15, 23, 42, 0.22);
  }

  .timeline-page .tl-reveal {
    opacity: 0;
    transform: translateY(16px);
    animation: tl-reveal 0.85s ease forwards;
    animation-delay: var(--tl-delay, 0s);
  }

  @keyframes tl-reveal {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @media (min-width: 768px) {
    .timeline-page .tl-rail::before {
      left: 50%;
      transform: translateX(-50%);
    }

    .timeline-page .tl-marker {
      left: 50%;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .timeline-page .tl-reveal {
      animation: none;
      opacity: 1;
      transform: none;
    }
  }
</style>
